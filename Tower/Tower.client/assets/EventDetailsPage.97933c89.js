import{a as v,o as c,b as i,d as t,h as u,t as l,F as h,D as k,j as V,v as j,e as g,w as E,i as A,E as P,l as F,c as r,z as B,s as N,x as R,f as p}from"./vendor.1a0d30b4.js";import{_ as M,A as n,e as f,t as w,c as x,l as m,P as d}from"./index.1eead204.js";const y={setup(){const o=A({}),s=P();let b=new Intl.DateTimeFormat("en",{dateStyle:"short",timeStyle:"short"});return F(async()=>{if(s.params.id)try{n.activeEvent={},await f.getById(s.params.id),await w.getEventTickets(s.params.id),await x.getEventComments(s.params.id)}catch(e){m.error(e),d.toast(e.message,"error")}}),{editable:o,dateFormat:b,route:s,account:r(()=>n.account),activeEvent:r(()=>n.activeEvent),comments:r(()=>n.comments),tickets:r(()=>n.tickets),myTickets:r(()=>n.myTickets),user:r(()=>n.user),hasTicket:r(()=>n.tickets.find(e=>e.id==n.account.id||e.accountId==n.account.id)),backgroundImage:r(()=>`url('${n.activeEvent.coverImg}')`),async addComment(){try{o.value.eventId=s.params.id,await x.createComment(o.value),o.value={}}catch(e){m.error(e),d.toast(e.message,"error")}},async createTicket(){try{n.user.isAuthenticated?(await w.createTicket(n.user.id,s.params.id),d.toast("RSVP submitted","success")):d.toast("You must be logged in to RSVP","error")}catch(e){m.error(e),d.toast(e.message,"error")}},async cancelEvent(){try{await d.confirm("Cancel Event","Are you sure you want to cancel this event? This can not be undone.","warning","Yes, cancel event!")&&(await f.cancelEvent(n.activeEvent.id),d.toast("Event cancelled!","success"))}catch(e){m.error(e),d.toast(e.message,"error")}},popToast(){d.toast("You're already going!","warning")}}}},C=()=>{B(o=>({"9e9488fc":o.backgroundImage}))},S=y.setup;y.setup=S?(o,s)=>(C(),S(o,s)):C;const Y=y,_=o=>(N("data-v-4dbead98"),o=o(),R(),o),L={class:"event-details-page container-fluid text-light"},z={class:"row p-3"},J={class:"col-12 rounded border border-primary shadow p-5 bg-grey event-details"},U={class:"row"},W={class:"col-md-4"},q=["src"],G={class:"col-md-8 d-flex flex-column justify-content-between"},H={key:0,class:"text-end"},K=_(()=>t("i",{"data-bs-toggle":"modal","data-bs-target":"#edit-event",title:"Edit event",class:"mdi mdi-pencil text-warning pe-2 selectable"},null,-1)),O={class:"d-flex justify-content-between"},Q={class:"d-flex justify-content-between"},X={class:"lh-lg"},Z={key:0,class:"rounded bg-danger darken-20 w-100 text-center text-light"},$={key:1,class:"rounded bg-danger darken-20 w-100 text-center text-light"},ee={key:2,class:"d-flex justify-content-between"},te={key:0},se=p(" RSVP'd "),ae=_(()=>t("i",{class:"mdi mdi-human"},null,-1)),ne=[se,ae],oe={key:1},ce=p(" Attend "),ie=_(()=>t("i",{class:"mdi mdi-human"},null,-1)),de=[ce,ie],re={key:0,class:"row p-3"},le=_(()=>t("div",{class:"col-12"},"See who is attending",-1)),_e={class:"col-12 p-2 bg-grey d-flex"},me=["src","title"],ve={class:"row"},ue={class:"col-8 offset-2"},he=_(()=>t("p",{class:"mb-1"},"What are people saying",-1)),ge={class:"bg-grey rounded shadow p-3"},pe={key:0},ye=_(()=>t("p",{class:"text-end"},"Join the conversation",-1)),be={class:"text-end"},ke=p("Edit Event");function Ee(o,s,b,e,fe,we){const T=v("Comment"),I=v("EditEventForm"),D=v("Modal");return c(),i(h,null,[t("div",L,[t("div",z,[t("div",J,[t("div",U,[t("div",W,[t("img",{src:e.activeEvent.coverImg,alt:"",class:"img-fluid rounded shadow"},null,8,q)]),t("div",G,[t("div",null,[!e.activeEvent.isCanceled&&e.activeEvent.creatorId==e.account.id?(c(),i("div",H,[K,t("i",{onClick:s[0]||(s[0]=(...a)=>e.cancelEvent&&e.cancelEvent(...a)),title:"Cancel event",class:"mdi mdi-cancel text-danger ps-2 selectable"})])):u("",!0),t("div",O,[t("h3",null,l(e.activeEvent.name),1),t("h3",null,l(new Date(e.activeEvent.startDate).toDateString()),1)]),t("div",Q,[t("h4",null,l(e.activeEvent.location),1),t("h4",null,l(new Date(e.activeEvent.startDate).toLocaleTimeString()),1)]),t("p",X,l(e.activeEvent.description),1)]),e.activeEvent.isCanceled?(c(),i("span",Z," Cancelled")):e.activeEvent.capacity<=0?(c(),i("span",$,"At capacity")):(c(),i("div",ee,[t("h4",null,l(e.activeEvent.capacity)+" spots left",1),e.user.isAuthenticated&&e.hasTicket?(c(),i("div",te,[t("button",{onClick:s[1]||(s[1]=(...a)=>e.popToast&&e.popToast(...a)),class:"btn btn-success p-2 px-5"},ne)])):(c(),i("div",oe,[t("button",{onClick:s[2]||(s[2]=(...a)=>e.createTicket&&e.createTicket(...a)),class:"btn btn-warning p-2 px-5"},de)]))]))])])])]),e.tickets.length>0?(c(),i("div",re,[le,t("div",_e,[(c(!0),i(h,null,k(e.tickets,a=>(c(),i("img",{key:a.ticketId,src:a.picture,alt:"",class:"img-small rounded-circle m-1",title:a.name},null,8,me))),128))])])):u("",!0),t("div",ve,[t("div",ue,[he,t("div",ge,[e.user.isAuthenticated?(c(),i("div",pe,[ye,V(t("textarea",{"onUpdate:modelValue":s[3]||(s[3]=a=>e.editable.body=a),class:"form-control text-dark",placeholder:"Tell the people...",id:"comment",style:{height:"100px"}},null,512),[[j,e.editable.body]]),t("div",be,[t("button",{onClick:s[4]||(s[4]=(...a)=>e.addComment&&e.addComment(...a)),class:"btn btn-success my-2 p-2"}," Post comment ")])])):u("",!0),(c(!0),i(h,null,k(e.comments,a=>(c(),i("div",{class:"d-flex",key:a.id},[g(T,{comment:a},null,8,["comment"])]))),128))])])])]),g(D,{id:"edit-event"},{title:E(()=>[ke]),body:E(()=>[g(I)]),_:1})],64)}var Se=M(Y,[["render",Ee],["__scopeId","data-v-4dbead98"]]);export{Se as default};
